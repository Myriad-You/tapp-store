<!-- Myriad Config Generator Page v1.0.0 -->

<!-- 背景层 -->
<div id="tapp-background">
  <div class="page-bg-base"></div>
  <div class="page-bg-glow page-bg-glow-1"></div>
  <div class="page-bg-glow page-bg-glow-2"></div>
</div>

<!-- 内容层 -->
<div id="tapp-content">
  <div class="page-content">
    <!-- 标题区域 - 胶囊样式 -->
    <header class="page-header">
      <div class="header-icon">⚙️</div>
      <div class="header-info">
        <h1 class="header-title">Myriad 安装配置生成</h1>
        <p class="header-subtitle">快速生成 Docker Compose 和 Nginx 配置文件</p>
      </div>
    </header>

    <!-- 配置表单 -->
    <div class="config-form">
      <!-- 域名配置 -->
      <section class="form-section">
        <h2 class="section-title">
          <span class="section-icon">🌐</span>
          域名配置
        </h2>
        <div class="form-group">
          <label for="main-domain">主域名 (前端)</label>
          <input type="text" id="main-domain" class="form-input" placeholder="example.com" autocomplete="off">
          <span class="form-hint">用于访问 Myriad 前端界面</span>
        </div>
        <div class="form-group">
          <label for="api-domain">API 域名 (后端)</label>
          <input type="text" id="api-domain" class="form-input" placeholder="api.example.com" autocomplete="off">
          <span class="form-hint">用于后端 API 服务</span>
        </div>
      </section>

      <!-- 安全配置 -->
      <section class="form-section">
        <h2 class="section-title">
          <span class="section-icon">🔐</span>
          安全配置
        </h2>
        <div class="form-group">
          <label for="db-password">数据库密码</label>
          <div class="input-with-action">
            <input type="text" id="db-password" class="form-input" placeholder="点击生成按钮生成强密码" readonly>
            <button type="button" id="gen-db-password" class="btn-generate" title="生成随机密码">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M21 2v6h-6M3 12a9 9 0 0 1 15-6.7L21 8M3 22v-6h6M21 12a9 9 0 0 1-15 6.7L3 16"/>
              </svg>
            </button>
          </div>
          <span class="form-hint">PostgreSQL 数据库密码，建议使用生成的强密码</span>
        </div>
        <div class="form-group">
          <label for="jwt-secret">JWT 密钥</label>
          <div class="input-with-action">
            <input type="text" id="jwt-secret" class="form-input" placeholder="点击生成按钮生成密钥" readonly>
            <button type="button" id="gen-jwt-secret" class="btn-generate" title="生成随机密钥">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M21 2v6h-6M3 12a9 9 0 0 1 15-6.7L21 8M3 22v-6h6M21 12a9 9 0 0 1-15 6.7L3 16"/>
              </svg>
            </button>
          </div>
          <span class="form-hint">用于 JWT 令牌签名的密钥，64 字符</span>
        </div>
      </section>

      <!-- 服务配置 -->
      <section class="form-section">
        <h2 class="section-title">
          <span class="section-icon">🔧</span>
          服务配置
        </h2>
        <div class="form-row">
          <div class="form-group form-group-half">
            <label for="backend-port">后端端口</label>
            <input type="number" id="backend-port" class="form-input" value="3000" min="1" max="65535">
            <span class="form-hint">Backend API 服务端口</span>
          </div>
          <div class="form-group form-group-half">
            <label for="frontend-port">前端端口</label>
            <input type="number" id="frontend-port" class="form-input" value="4321" min="1" max="65535">
            <span class="form-hint">Frontend 服务端口</span>
          </div>
        </div>
        <div class="form-group">
          <label for="db-version">PostgreSQL 版本</label>
          <select id="db-version" class="form-input form-select">
            <option value="16">PostgreSQL 16 (推荐)</option>
            <option value="17">PostgreSQL 17 (最新)</option>
          </select>
          <span class="form-hint">选择数据库版本，16 更稳定，17 有新特性</span>
        </div>
      </section>

      <!-- 资源限制 -->
      <section class="form-section">
        <h2 class="section-title">
          <span class="section-icon">📊</span>
          资源限制
        </h2>
        <p class="section-desc">配置各服务的 CPU 和内存限制（Docker Compose deploy 配置）</p>
        
        <!-- 数据库资源 -->
        <div class="resource-group">
          <div class="resource-label">🗄️ PostgreSQL</div>
          <div class="form-row">
            <div class="form-group form-group-half">
              <label for="db-cpu-limit">CPU 限制</label>
              <input type="text" id="db-cpu-limit" class="form-input" value="1.0" placeholder="1.0">
              <span class="form-hint">CPU 核心数，如 0.5, 1.0, 2.0</span>
            </div>
            <div class="form-group form-group-half">
              <label for="db-mem-limit">内存限制</label>
              <input type="text" id="db-mem-limit" class="form-input" value="1G" placeholder="1G">
              <span class="form-hint">如 512M, 1G, 2G</span>
            </div>
          </div>
        </div>

        <!-- 后端资源 -->
        <div class="resource-group">
          <div class="resource-label">⚙️ Backend</div>
          <div class="form-row">
            <div class="form-group form-group-half">
              <label for="backend-cpu-limit">CPU 限制</label>
              <input type="text" id="backend-cpu-limit" class="form-input" value="1.0" placeholder="1.0">
            </div>
            <div class="form-group form-group-half">
              <label for="backend-mem-limit">内存限制</label>
              <input type="text" id="backend-mem-limit" class="form-input" value="1G" placeholder="1G">
            </div>
          </div>
        </div>

        <!-- 前端资源 -->
        <div class="resource-group">
          <div class="resource-label">🎨 Frontend</div>
          <div class="form-row">
            <div class="form-group form-group-half">
              <label for="frontend-cpu-limit">CPU 限制</label>
              <input type="text" id="frontend-cpu-limit" class="form-input" value="1.0" placeholder="1.0">
            </div>
            <div class="form-group form-group-half">
              <label for="frontend-mem-limit">内存限制</label>
              <input type="text" id="frontend-mem-limit" class="form-input" value="1G" placeholder="1G">
            </div>
          </div>
        </div>
      </section>

      <!-- Nginx 配置上传 -->
      <section class="form-section">
        <h2 class="section-title">
          <span class="section-icon">📄</span>
          Nginx 配置 (可选)
        </h2>
        <p class="section-desc">上传您现有的 Nginx 配置文件，保留 SSL 设置并替换域名</p>
        
        <!-- 警告提示框 -->
        <div class="section-warning">
          <span class="section-warning-icon">⚠️</span>
          <div class="section-warning-content">
            <span class="section-warning-title">上传要求</span>
            请上传<strong>纯净的、仅配置好 SSL 证书</strong>的 Nginx 配置文件。<br>
            复杂的配置文件（包含多个 server 块、复杂的 location 规则等）可能无法正确处理。<br>
            如不上传，将使用默认模板生成（无 SSL，需要手动配置）。
          </div>
        </div>
        
        <div class="upload-group">
          <div class="upload-item">
            <label>主域名 Nginx 配置</label>
            <div class="upload-box" id="upload-main-conf">
              <input type="file" id="file-main-conf" accept=".conf" hidden>
              <div class="upload-placeholder">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4M17 8l-5-5-5 5M12 3v12"/>
                </svg>
                <span>点击上传或拖拽文件</span>
              </div>
              <div class="upload-success" hidden>
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/>
                  <polyline points="22 4 12 14.01 9 11.01"/>
                </svg>
                <span class="file-name"></span>
                <button type="button" class="btn-remove" title="移除">×</button>
              </div>
            </div>
          </div>
          
          <div class="upload-item">
            <label>API 域名 Nginx 配置</label>
            <div class="upload-box" id="upload-api-conf">
              <input type="file" id="file-api-conf" accept=".conf" hidden>
              <div class="upload-placeholder">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4M17 8l-5-5-5 5M12 3v12"/>
                </svg>
                <span>点击上传或拖拽文件</span>
              </div>
              <div class="upload-success" hidden>
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/>
                  <polyline points="22 4 12 14.01 9 11.01"/>
                </svg>
                <span class="file-name"></span>
                <button type="button" class="btn-remove" title="移除">×</button>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- 生成按钮 -->
      <div class="form-actions">
        <button type="button" id="btn-generate-all" class="btn-primary">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M12 5v14M5 12h14"/>
          </svg>
          生成配置文件
        </button>
      </div>
    </div>

    <!-- 生成结果 -->
    <div id="results-section" class="results-section" hidden>
      <h2 class="results-title">📦 生成结果</h2>
      
      <!-- Docker Compose -->
      <div class="result-card">
        <div class="result-header">
          <span class="result-icon">🐳</span>
          <span class="result-name">docker-compose.yml</span>
          <button type="button" class="btn-copy" data-target="docker-compose">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <rect x="9" y="9" width="13" height="13" rx="2" ry="2"/>
              <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/>
            </svg>
            复制
          </button>
          <button type="button" class="btn-download" data-filename="docker-compose.yml" data-target="docker-compose">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4M7 10l5 5 5-5M12 15V3"/>
            </svg>
            下载
          </button>
        </div>
        <pre class="result-content"><code id="result-docker-compose"></code></pre>
      </div>

      <!-- Main Nginx Config -->
      <div class="result-card" id="card-main-nginx">
        <div class="result-header">
          <span class="result-icon">📄</span>
          <span class="result-name" id="name-main-nginx">example.com.conf</span>
          <button type="button" class="btn-copy" data-target="main-nginx">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <rect x="9" y="9" width="13" height="13" rx="2" ry="2"/>
              <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/>
            </svg>
            复制
          </button>
          <button type="button" class="btn-download" data-filename="main.conf" data-target="main-nginx">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4M7 10l5 5 5-5M12 15V3"/>
            </svg>
            下载
          </button>
        </div>
        <pre class="result-content"><code id="result-main-nginx"></code></pre>
      </div>

      <!-- API Nginx Config -->
      <div class="result-card" id="card-api-nginx">
        <div class="result-header">
          <span class="result-icon">📄</span>
          <span class="result-name" id="name-api-nginx">api.example.com.conf</span>
          <button type="button" class="btn-copy" data-target="api-nginx">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <rect x="9" y="9" width="13" height="13" rx="2" ry="2"/>
              <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/>
            </svg>
            复制
          </button>
          <button type="button" class="btn-download" data-filename="api.conf" data-target="api-nginx">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4M7 10l5 5 5-5M12 15V3"/>
            </svg>
            下载
          </button>
        </div>
        <pre class="result-content"><code id="result-api-nginx"></code></pre>
      </div>
    </div>
  </div>
</div>
